{% load static %}
<!DOCTYPE html>
<!--[if IE 8]><html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
  <!--<![endif]-->

  <head>
    <!-- Basic Page Needs -->
    <meta charset="utf-8" />
    <!--[if IE
      ]><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"
    /><![endif]-->
    <title>RMP - Real Estate Market Place</title>

    <meta name="author" content="REM.com" />

    <!-- Mobile Specific Metas -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />

    <!-- Google Font: Inter -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <!-- Theme & Vendor Styles -->
    <link rel="stylesheet" href="{% static 'assets/css/animate.min.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/animation.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/bootstrap.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'assets/css/bootstrap-select.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/style2.css' %}" />

    <!-- Icon Fonts -->
    <link rel="stylesheet" href="{% static 'assets/icon2/style.css' %}" />

    <!-- Favicon and Touch Icons -->
    <link rel="shortcut icon" href="{% static 'images/logo/REM.png' %}" />
    <link
      rel="apple-touch-icon-precomposed"
      href="{% static 'images/logo/REM.png' %}"
    />

    <!-- Bootstrap CDN (optional if not relying on this instead of local) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU5C6kDkWc33RWtb07i1zV2Rb/pkzNf0k0GmQ5wF0p6H2w5"
      crossorigin="anonymous"
    />
  </head>

  <body class="body">
    <!-- #wrapper -->
    <div id="wrapper">
      <!-- #page -->
      <div id="page" class="">
        <!-- layout-wrap -->
        <div class="layout-wrap">
          <!-- preload -->
          <div id="preload" class="preload-container">
            <div class="preloading">
              <span></span>
            </div>
          </div>
          <!-- /preload -->
          <!-- section-menu-left -->
          <div class="section-menu-left">
            <div class="box-logo">
              <div class="button-show-hide">
                <i class="icon-menu-left"></i>
              </div>
            </div>
            <div class="center">
              <div class="center-item">
                {% if request.user.role == "Agent" %}
                <a
                  href="{% url 'users:agent_dashboard' %}"
                  class="center-heading"
                  >Main Home</a
                >
                {% elif request.user.role == "Prospective Buyer/Tenant" %}
                <a
                  href="{% url 'users:user_dashboard' %}"
                  class="center-heading"
                  >Main Home</a
                >
                {% endif %}
                <ul class="menu-list">
                  <li
                    class="menu-item has-children {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
                  >
                    <a href="javascript:void(0);" class="menu-item-button">
                      <div class="icon"><i class="icon-grid"></i></div>
                      <div class="text">Dashboard</div>
                    </a>

                    {% if request.user.role == "Agent" %}
                    <ul class="sub-menu" style="display: block">
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'property_create' %}active{% endif %}"
                      >
                        <a href="{% url 'property:property_create' %}" class="">
                          <div class="icon"><i class="icon-plus"></i></div>
                          <div class="text">Add Property</div>
                        </a>
                      </li>
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'property_list' %}active{% endif %}"
                      >
                        <a href="{% url 'property:property_list' %}" class="">
                          <div class="icon"><i class="icon-list"></i></div>
                          <div class="text">List Property</div>
                        </a>
                      </li>
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'message_list' %}active{% endif %}"
                      >
                        <a
                          href="{% url 'notification:message_list' %}"
                          class=""
                        >
                          <div class="icon">
                            <i class="icon-message-square"></i>
                          </div>
                          <div class="text">Messages</div>
                        </a>
                      </li>

                      <li
                        class="sub-menu-item {% if 'subscriptions' in request.resolver_match.app_names %}active{% endif %}"
                      >
                        {% if user.agent_profile.has_active_subscription %}
                        <a
                          href="{% url 'subscriptions:detail' user.agent_profile.current_subscription.pk %}"
                          class=""
                        >
                          <div class="icon">
                            <i class="icon-credit-card"></i>
                          </div>
                          <div class="text">View My Subscription</div>
                        </a>
                        {% else %}
                        <a href="{% url 'subscriptions:start' %}" class="">
                          <div class="icon">
                            <i class="icon-credit-card"></i>
                          </div>
                          <div class="text">Subscribe Now</div>
                        </a>
                        {% endif %}
                      </li>
                    </ul>
                    {% else %}
                    <ul class="sub-menu" style="display: block">
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'customers_favorite_list' %}active{% endif %}"
                      >
                        <a
                          href="{% url 'property:customers_favorite_list' %}"
                          class=""
                        >
                          <div class="icon"><i class="icon-heart"></i></div>
                          <div class="text">My Favorites</div>
                        </a>
                      </li>
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'lead_list' %}active{% endif %}"
                      >
                        <a href="{% url 'property:lead_list' %}" class="">
                          <div class="icon"><i class="icon-users"></i></div>
                          <div class="text">Leads</div>
                        </a>
                      </li>
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'message_list' %}active{% endif %}"
                      >
                        <a
                          href="{% url 'notification:message_list' %}"
                          class=""
                        >
                          <div class="icon">
                            <i class="icon-message-square"></i>
                          </div>
                          <div class="text">Messages</div>
                        </a>
                      </li>
                    </ul>
                    {% endif %}
                  </li>

                  <!-- Additional menu items for other sections -->
                  <li
                    class="menu-item has-children {% if 'notification' in request.resolver_match.app_names %}active{% endif %}"
                  >
                    <a href="javascript:void(0);" class="menu-item-button">
                      <div class="icon"><i class="icon-bell"></i></div>
                      <div class="text">Notifications</div>
                    </a>
                    <ul class="sub-menu">
                      <li
                        class="sub-menu-item {% if request.resolver_match.url_name == 'notification_list' %}active{% endif %}"
                      >
                        <a
                          href="{% url 'notification:notification_list' %}"
                          class=""
                        >
                          <div class="icon"><i class="icon-list"></i></div>
                          <div class="text">All Notifications</div>
                        </a>
                      </li>
                    </ul>
                  </li>

                  <li
                    class="menu-item {% if 'profile' in request.resolver_match.app_names %}active{% endif %}"
                  >
                    <a href="" class="">
                      <div class="icon"><i class="icon-user"></i></div>
                      <div class="text">My Profile</div>
                    </a>
                  </li>

                  <li class="menu-item">
                    <a href="{% url 'account_logout' %}" class="">
                      <div class="icon"><i class="icon-log-out"></i></div>
                      <div class="text">Logout</div>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <!-- /section-menu-left -->

          <!-- Rest of your template remains the same -->
          <div class="section-content-right">
            <!-- header-dashboard -->
            <div class="header-dashboard">
              <div class="wrap">
                <div class="header-left">
                  <a href="{% url 'home:home' %}">
                    <img
                      class=""
                      id="logo_header_mobile"
                      alt=""
                      src="{% static 'images/logo/REM Logo.png' %}"
                      data-light="{% static 'images/logo/REM Logo.png' %}"
                      data-dark="{% static 'images/logo/REM.png' %}"
                      data-width="154px"
                      data-height="52px"
                      data-retina="{% static 'images/logo/REM Logo.png' %}"
                      style="height: 70px"
                    />
                  </a>
                  <div class="button-show-hide">
                    <i class="icon-menu-left"></i>
                  </div>
                </div>
                <div class="header-grid">
                  <div class="header-item button-dark-light">
                    <i class="icon-moon"></i>
                  </div>
                  <div class="popup-wrap message type-header">
                    <div class="dropdown">
                      <button
                        class="btn btn-secondary dropdown-toggle"
                        type="button"
                        id="dropdownMenuButton2"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        <span class="header-item">
                          <span class="text-tiny"
                            >{{unmarked_notifications}}</span
                          >
                          <i class="icon-message-square"></i>
                        </span>
                      </button>
                      <ul
                        class="dropdown-menu dropdown-menu-end has-content"
                        aria-labelledby="dropdownMenuButton2"
                      >
                        <li>
                          <h6>Notifications</h6>
                        </li>
                        {% for latest_notification in latest_notifications %}
                        <li>
                          <div class="message-item item-1">
                            <div class="image">
                              <i class="icon-noti-1"></i>
                            </div>
                            <div>
                              <div class="body-title-2">
                                {{ latest_notification.notification_type}}
                              </div>
                              <div class="text-tiny">
                                {{latest_notification.message|truncatechars:10}}
                              </div>
                            </div>
                          </div>
                        </li>
                        {% endfor %}
                        <li>
                          <a
                            href="{% url 'notification:notification_list' %}"
                            class="tf-button w-full"
                            >View all</a
                          >
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="header-item button-zoom-maximize">
                    <div class="">
                      <i class="icon-maximize"></i>
                    </div>
                  </div>
                  <div class="popup-wrap user type-header">
                    <div class="dropdown">
                      <button
                        class="btn btn-secondary dropdown-toggle"
                        type="button"
                        id="dropdownMenuButton3"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        <span class="header-user wg-user">
                          <span class="flex flex-column">
                            <span class="body-title mb-2"
                              >{{ request.user.name.capitalize }}</span
                            >
                            <span class="text-tiny">
                              {% if request.user.role == "Agent" %}
                              Agent
                              {% else %}
                              Customer
                              {% endif %}
                            </span>
                          </span>
                        </span>
                      </button>
                      <ul
                        class="dropdown-menu dropdown-menu-end"
                        aria-labelledby="dropdownMenuButton3"
                      >
                        <li>
                          <a class="dropdown-item" href="{% url 'home:home' %}">
                            <i class="icon-home me-2"></i>Back to Main Site
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- /header-dashboard -->
            {% include 'partials/messages.html' %}
            {% block content %}

            {% endblock content %}
          </div>
          <!-- /section-content-right -->
        </div>
        <!-- /layout-wrap -->

        <!-- bottom-page -->
        <div class="bottom-page">
          <div class="body-text">Copyright © 2025 REM. Design with</div>
          <i class="icon-heart"></i>
          <div class="body-text">
            by <a href="#">REM</a> All rights reserved.
          </div>
        </div>
        <!-- /bottom-page -->
      </div>
      <!-- /#page -->
    </div>
    <!-- /#wrapper -->

    <!-- Javascript -->
    <script src="{% static 'assets/js/jquery.min.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap-select.min.js' %}"></script>
    <script src="{% static 'assets/js/zoom.js' %}"></script>
    <script src="{% static 'assets/js/jvectormap-1.2.2.min.js' %}"></script>
    <script src="{% static 'assets/js/jvectormap-us-lcc.js' %}"></script>
    <script src="{% static 'assets/js/jvectormap.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/apexcharts.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/line-chart-1.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/line-chart-2.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/line-chart-3.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/line-chart-4.js' %}"></script>
    <script src="{% static 'assets/js/apexcharts/line-chart-7.js' %}"></script>
    <script src="{% static 'assets/js/switcher.js' %}"></script>
    <script src="{% static 'assets/js/theme-settings.js' %}"></script>
    <script src="{% static 'assets/js/main.js' %}"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-QF1m4QcHTaYIhD1RAJ1YrZ+hV6RMCv9mGbOfZs8B5TTYYUq9F71YOGvHkOZef4Jp"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
